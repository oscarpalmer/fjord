// Generated by CoffeeScript 1.4.0
(function(){var e,t,n,r,i;n=window.location.protocol+"//"+window.location.host+"/";i=!!window.history&&!!window.history.pushState&&!!window.history.replaceState;t=[];r=window.location.href;e={cache:function(e,n,r){var i;if(this.cached(e)){i=this.find(e);i.x=n.pageXOffset;return i.y=n.pageYOffset}i={body:r.body.innerHTML,title:r.title,url:e,x:0,y:0};return t.push(i)},cached:function(e){var n,r,i;for(r=0,i=t.length;r<i;r++){n=t[r];if(n.url===e)return!0}return!1},find:function(e){var n,r,i;for(r=0,i=t.length;r<i;r++){n=t[r];if(n.url===e)return n}},render:function(e,t){document.body.innerHTML=e.body;document.title=e.title;r=e.url;t==="pop"&&window.scrollTo(e.x,e.y);t==="push"&&window.history.pushState({path:e.url},"",e.url);return this.trigger("fjord:ready")},request:function(){try{return new XMLHttpRequest}catch(e){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){return new ActiveXObject("Msxml2.XMLHTTP.3.0")}}}},trigger:function(e){var t;t=document.createEvent("Events");t.initEvent(e,!0,!0);return document.dispatchEvent(t)},visit:function(t,n){var i,s,o;s=n==="pop"?r:window.location.href;this.trigger("fjord:load");this.cache(s,window,document);if(this.cached(t)){i=this.find(t);return this.render(i,n)}o=this.request();o.onload=function(){var r,s,u;r=o.responseText.replace(/\s+/g," ").replace(/\t+/g,"");s=r.replace(/^(.*)<body>(.*)<\/body>(.*)$/,"$2");u=r.replace(/^(.*)<title>(.*)<\/title>(.*)$/,"$2");i={body:s,title:u,url:t,x:0,y:0};return e.render(i,n)};o.open("get",t,!0);return o.send(null)}};if(i){window.onload=function(){return history.replaceState({path:window.location.href},"")};window.onpopstate=function(t){var n;n=t.state;if((n!=null?n.path:void 0)!=null)return e.visit(n.path,"pop")};window.onclick=function(t){var r;r=t.target;if(r.tagName==="A"&&r.href.indexOf(n)===0){t.preventDefault();if(r.href!==window.location.href)return e.visit(r.href,"push")}}}}).call(this);