(function(){var e,t,n,r=window.location.protocol+"//"+window.location.host+"/",i=!!window.history&&!!window.history.pushState&&!!window.history.replaceState;t=[];e={cache:function(e,n,r){if(this.cached(e)){var i;i=this.find(e);i.x=n.pageXOffset;i.y=n.pageYOffset}else t.push({body:r.body.innerHTML,title:r.title,url:e,x:n.pageXOffset,y:n.pageYOffset})},cached:function(e){var n=0,r=t.length;for(;n<r;n++)if(t[n].url===e)return!0;return!1},find:function(e){var n=0,r=t.length;for(;n<r;n++)if(t[n].url===e)return t[n]},render:function(e,t){document.body.innerHTML=e.body;document.title=e.title;n=e.url;t==="pop"?window.scrollTo(e.x,e.y):t==="push"&&window.history.pushState({path:e.url},"",e.url);this.trigger("fjord:ready")},request:function(){try{return new XMLHttpRequest}catch(e){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){return new ActiveXObject("Msxml2.XMLHTTP.3.0")}}}},trigger:function(e){var t;t=document.createEvent("Events");t.initEvent(e,!0,!0);document.dispatchEvent(t)},visit:function(t,r){this.trigger("fjord:load");this.cache(r==="pop"?n:window.location.href,window,document);if(this.cached(t))this.render(e.find(t),r);else{var i,s,o,u;u=this.request();u.onload=function(){i=u.responseText.replace(/\s+/g," ").replace(/\t+/g,"");s=i.replace(/^(.*)<body>(.*)<\/body>(.*)$/,"$2");o=i.replace(/^(.*)<title>(.*)<\/title>(.*)$/,"$2");e.render({body:s,title:o,url:t,x:0,y:0},r)};u.open("get",t,!0);u.send(null)}}};if(i){window.onload=function(){history.replaceState({path:window.location.href},"")};window.onpopstate=function(t){var n;n=t.state;n!==null&&n.path!==null&&e.visit(n.path,"pop")};window.onclick=function(t){var n;n=t.target;if(n.tagName==="A"&&n.href.indexOf(r)===0){t.preventDefault();n.href!==window.location.href&&e.visit(n.href,"push")}}}})();