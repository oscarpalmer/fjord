(function(){function p(e,t){var n=0,r=e.length;for(;n<r;n++)t(e[n],n)}var e,t=window,n=t.document,r=[],i=t.location.href,s=t.location.protocol+"//"+t.location.host+"/",o=!!t.history,u="createEvent",a="onload",f="push",l="responseText",c="PageXOffset",h="PageYOffset";e={cache:function(i){var s;if(e.cached(i)){s=e.find(i);s.x=t[c];s.y=t[h]}else{s={body:n.body.innerHTML,title:n.title,url:i,x:t[c],y:t[h]};r.push(s)}},cached:function(e){var t;p(r,function(n){n.url===e&&(t=!0)});return t||!1},find:function(e){var t;p(r,function(n){n.url===e&&(t=n)});return t},render:function(r,s){n.body.innerHTML=r.body;n.title=r.title;i=r.url;s===f?history.pushState({fjord:r.url},"",r.url):t.scrollTo(r.x,r.y);e.trigger("fjord:ready")},request:function(){return t.XMLHttpRequest?new t.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},trigger:function(e){var t;if(n[u]){t=n[u]("Event");t.initEvent(e,!0,!0)}else t=new Event(e);n.dispatchEvent(t)},visit:function(n,r){var s,o=r===f?t.location.href:i;e.trigger("fjord:load");e.cache(o);if(e.cached(n))e.render(e.find(n),r);else{s=e.request();s[a]=function(){e.render({body:s[l].replace(/^[\s\S]+?<body>([\s\S]+?)<\/body>[\s\S]+?$/,"$1"),title:s[l].replace(/^[\s\S]+?<title>([\s\S]+?)<\/title>[\s\S]+?$/,"$1"),url:n,x:0,y:0},r)};s.open("GET",n,!0);s.send(null)}}};if(o){t[a]=function(){history.replaceState({fjord:t.location.href},"")};t.onclick=function(n){var r=n.target;if(r.tagName==="A"&&r.href.indexOf(s)===0){n.preventDefault();r.href!==t.location.href&&e.visit(r.href,f)}};t.onpopstate=function(t){var n=t.state;n&&n.fjord&&e.visit(n.fjord,"pop")}}})();